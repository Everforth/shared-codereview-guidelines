## レビュープロセス（必須手順）

### STEP 1: 層の特定
以下の順序でコード変更を確認し、問題が見つかった最初の1つの層を特定してください。
順序は必ず守ってください。

1. DB層（Entity定義, 型定義, DTO, スキーマ定義 等）
  - データモデルの整合性、制約・インデックスの適切性、型定義の一貫性
2. Service層（ビジネスロジック、データ処理 等）
  - ビジネスロジックの正確性、トランザクション境界の適切性、データ変換処理
3. Controller層（エンドポイント、リクエスト/レスポンス処理 等）
  - エンドポイント設計、バリデーション・エラーハンドリング、HTTPステータスコード
4. その他（テストコード, 設定ファイル 等）

### STEP 2: レビュー実施
STEP 1で特定した1つの層のみをレビューしてください。

### 禁止事項（重要）

1. 複数の層をレビューしない
  - 最初に問題を発見した層以外のコードについて言及しないでください
  - 例: DB層で問題を発見したら、Service層やController層の問題は指摘しない
  - 例: DB層に問題がないことを確認する前にService層の問題を指摘しない
2. 総評・まとめ・良い点の言及は不要
  - 「総評」「まとめ」「全体として」などのセクションを作成しない
  - 「〜が良いです」「〜は適切です」などのポジティブな評価を記載しない
3. 次の層のレビューを促さない
  - 「次にService層を確認してください」などの指示を出さない

### レビュー観点

#### 基本原則
- コードの可読性と保守性を最優先
- 既存の設計パターンやベストプラクティスに従う
- 無駄を削ぎ落とし、シンプルで綺麗なコードを目指す

#### 必須チェック項目
- 責務分離: Controller/Serviceの役割が適切に分離されているか
- 型設計: DTOでPartialTypeを活用し、既存型定義を再利用しているか
- DB操作: TypeORMクエリが最適化され、N+1問題を避けているか
- エラー処理: 適切なHTTPステータスコードを返し、意味のあるエラーメッセージを提供しているか
- バリデーション: DTOに必要な検証デコレータが適用されているか
- セキュリティ: 認証・認可ガードが正しく設定されているか
- テスト: 権限チェックを含む包括的なテストが実装されているか

#### パフォーマンス考慮点
- バッチ処理での一括操作
- 適切なキャッシュ戦略（TTL設定）
- 不要なDB呼び出しの削減

#### 設計・命名規則
- RESTfulなAPI設計
- モジュール間で名前の衝突を避ける
- Migrationの適切な統合
- 特殊な実装には必ずコメントで理由を明記