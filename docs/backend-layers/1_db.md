## DB層（Entity定義, 型定義, スキーマ定義 等）

### 必須チェック項目：

- 意図確認: PRの説明文やIssueの内容と実装に違和感がある場合、意図を確認するためにユーザーに質問すること
- データモデル設計: 何をしたいからどういうデータモデルであるべきかの意図が明確で適切か
- 命名規則: テーブル名やカラム名が業務の意味を正確に表現し、一貫性があるか
- 制約設計: 状態を極力持たず、DB制約でデータの整合性を保証することでService層のif文を減らしているか
- NOT NULL制約: そのカラムの値がなければレコード自体が意味をなさない場合は、nullableにせずNOT NULL制約を設ける
- 型設計: 既存型定義を再利用しているか
- DB操作: TypeORMクエリが最適化され、N+1問題を避けているか
- Enum定義: Enumを Entity内に書かず、types/ディレクトリ内ファイルに分離する
- デフォルト値: カラムに適切なdefault値を設定し、マジックナンバーではなく定義済み定数を使用する
- nullと空文字の使い分け: nullと空文字を区別する明確なユースケースがない場合は、`nullable: true`ではなく`default: ''`を使用する
- nullableカラムの型定義: `nullable: true`を設定した上でoptional markをつける（例: `price?: number`）
- @Column内の省略: `nullable: false`などのデフォルト値は明示しない
- 外部キー定義: `@JoinColumn`を使用する場合、対応する外部キーカラムも明示的に定義する
- Entityのコンストラクタ: 外部キーを持つEntityは、コンストラクタで必要な引数を受け取れるようにする
- 情報の重複回避: 他のカラムやリレーションから導出可能な情報は、別カラムとして持たない
- リレーションの優先: 会社名などマスタデータを参照すべき値は、文字列カラムではなくリレーションで定義する

### パフォーマンス考慮点：

- バッチ処理での一括操作
- 不要なDB呼び出しの削減

### 設計考慮点：

- Migrationの適切な統合
- 既存データがあるテーブルにNOT NULLカラムを追加する場合、一時的にdefault値を設定し削除用のTODOを残す

### レビュー対象外：

以下はDB層ではなく、他の層でレビューすること：

- **DTOファイル**（_.dto.ts、_.request.dto.ts、\*.response.dto.ts）→ Controller層で扱う
- **CRUD処理の実装**（find、save、update、deleteメソッド等）→ Service層で扱う
- **ビジネスロジック**（データの加工、計算、判定処理）→ Service層で扱う
- **APIエンドポイントの定義** → Controller層で扱う
